<html>

<head>
    <title>Cheney Brothers | DAM Bulk Import</title>
</head>

<body>
<div align="center"><img src="img/logo.png" width="100px"/><br></br></div>
<SCRIPT src="script/app.js" type="text/javascript"></script>
<H3>Bulk Import</H3>
<style>
body, div {
font-family: sans-serif;
}
div{
margin-left:10px;
}
#treeDemo{
margin-top: -55px;
}
td{
padding: 10px;
}
.err{
color:red;
font-size:14px;
}
.success{
color:green;
font-size:1rpx;
}

</style>
<table width="100%">
    <tr>
        <td>
            <ul id="treeDemo" class="ztree"></ul>
        </td>
        <td>
            <table>
                <tr>
                    <td>Destination Folder:</td>
                    <td><input type="text" name="dfolder" value="" placeholder="Destination folder" disabled/>
                        <input type="hidden" name="dhfolder" value=""/></td>
                </tr>
                <tr>
                    <td>Source Location:</td>
                    <td><input type="text" name="sfolder" placeholder="Source folder"/></td>
                </tr>
                <tr>
                    <td>
                        <button>Clear</button>
                    </td>
                    <td>
                        <button>Start</button>
                    </td>
                </tr>
                <tr>
                    <td claspan="2"></td>
                </tr>
            </table>
            <div class="err"></div>
            <div class="success"></div>
        </td>
    </tr>
</table>

<link rel="stylesheet" href="css/zTreeStyle/zTreeStyle.css" type="text/css">
<SCRIPT type="text/javascript">
        var folders = {
            "Hybris":"b12dd0cc95afc7cb641f9595182ed47745a091da",
            "Media":"18a761d386e187f35190562ec39844b8b0211e2b"
        };
		$(document).ready(function(){
			$('input[type=file]').change(function () {
				console.log(this.files[0].mozFullPath);
			});
			$($("button")[1]).click(function(){
			    $("input[type='text']").siblings("span").html("");
                if($($("input[type='text']")[0]).val() == "")
                    $(".err").html("Destination location empty!");
                else
                if($($("input[name='dhfolder']")).val() == "")
                    $(".err").html("Upload to 'My Folder' not allowed");
                else if($($("input[type='text']")[1]).val() == "")
                    $(".err").html("Source location empty!");
                else{
                   $.ajax({
                      method: "POST",
                      url: "/util",
                      data: { dfolder: $("input[name='dhfolder']").val(), sfolder: $("input[name='sfolder']").val() }
                    })
                    .done(function( msg ) {
                        $(".err").html(JSON.parse(msg).error);
                        $(".success").html(JSON.parse(msg).output);
                    });
                }
            });
            $($("button")[0]).click(function(){
                $("input[type='text']").val("");
                $("input[type='text']").siblings("span").html("");
            });
		});

        setInterval(function() {
           if ($("input[name='dfolder'").length) {
              $("#treeDemo a").click(function(d){
                $("input[name='dfolder'").val($(this).children(".node_name").html());
                $("input[name='dhfolder'").val(folders[$(this).children(".node_name").html()]);
              });
           }
        }, 1000);
        var setting = {
            data: {
                simpleData: {
                enable: true
                }
            }
		};

		var zNodes =[
		{ id:"1001N", name:"My Folder", open:true},
		{ id:"b12dd0cc95afc7cb641f9595182ed47745a091da", pId:"1001N", name:"Hybris"},
		{ id:"18a761d386e187f35190562ec39844b8b0211e2b", pId:"1001N", name:"Media"}
		];
		$(document).ready(function(){
		$.fn.zTree.init($("#treeDemo"), setting, zNodes);
		});


</SCRIPT>

</body>

</html>